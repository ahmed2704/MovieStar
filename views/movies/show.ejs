<%- include('../partials/header.ejs') %>

<h1><%= movie.title %></h1>

<h2>Reviews</h2>

<% if (movie.reviews.length) { %>
<ul>
  <% movie.reviews.forEach((review) => { %>
  <li>
    <div class="rate">
      <strong>Rating:</strong> <%= review.rating %>/5🌟<br />
      <strong>Comment:</strong> <%= review.text %><br />
      <strong>Reviewed by:</strong> <%= review.user.username %>
    </div>
  </li>
  <% if (user._id.equals(review.user._id)) { %>
  <div class="edit-delete-container">
    <a href="/movies/<%= movie._id %>/edit">Edit Movie</a>
    <form action="/movies/<%= movie._id %>/reviews/<%= review._id %>?_method=DELETE" class="deleteForm" method="POST">
      <button type="submit" class="deleteBtn">❌</button>
    </form>
  </div>
  <% } %>
  <% }) %>
</ul>
<% } else { %>
  <p>No reviews yet. Be the first to review!</p>
  <% } %>

<h3>Add a review</h3>

<form action="/movies/<%= movie._id %>/reviews" method="POST">
  <label for="reviewsComment">Comments:</label>
  <input type="text" name="reviewsComment" id="reviewsComment" class="input"/>
  <label for="rating">Rate this movie:</label>
  <div class="rating">
    <input type="radio" id="star-1" name="reviewsRating" value="5">
    <label for="star-1" >
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path pathLength="360" d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"></path></svg>
    </label>
    <input type="radio" id="star-2" name="reviewsRating" value="4">
    <label for="star-2">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path pathLength="360" d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"></path></svg>
    </label>
    <input type="radio" id="star-3" name="reviewsRating" value="3">
    <label for="star-3">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path pathLength="360" d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"></path></svg>
    </label>
    <input type="radio" id="star-4" name="reviewsRating" value="2">
    <label for="star-4">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path pathLength="360" d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"></path></svg>
    </label>
    <input type="radio" id="star-5" name="reviewsRating" value="1">
    <label for="star-5">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path pathLength="360" d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"></path></svg>
    </label>
  </div>
  <button type="submit">Add Review</button>
</form>


<%- include('../partials/footer.ejs') %>